question                                                                                                                                                                                                   , expected_sql                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 , base_sql                                                                                                 , ft_sql                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       , base_semantic, ft_semantic, base_exec, ft_exec
Quel est le chiffre d'affaires des magasins situés à Lyon ?                                                                                                                                                , SELECT SUM(PRIX_AP_REMISE * QUANTITE) AS ca_lyon FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE UPPER(m.VILLE) LIKE '%LYON%' AND tc.ANNULATION = False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_lyon FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE UPPER(m.VILLE) LIKE '%LYON%' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ,           0.0,         0.0, False    , True
Quel est le CA total des magasins de LYON ?                                                                                                                                                                , SELECT SUM(PRIX_AP_REMISE * QUANTITE) AS ca_lyon FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE UPPER(m.VILLE) LIKE '%LYON%' AND tc.ANNULATION = False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                        , SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_lyon FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE UPPER(m.VILLE) LIKE '%LYON%' AND tc.ANNULATION = False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,           0.0,         0.0, False    , True
Quel est le CA du mois de mars 2019 ?                                                                                                                                                                      , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE SUBSTR(DATE_TICKET, 4, 2) = '03' AND SUBSTR(DATE_TICKET, 7, 4) = '2019' AND ANNULATION = False"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE SUBSTR(DATE_TICKET, 4, 2) = '03' AND SUBSTR(DATE_TICKET, 7, 4) = '2019' AND ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ,           0.0,         0.0, False    , True
Quel est le CA du premier semestre 2021 ?                                                                                                                                                                  , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE substr(CAST(DATE_TICKET as STRING), 7, 4) = '2021' AND CAST(substr(CAST(DATE_TICKET as STRING), 4, 2) AS INT64) <= 6 AND ANNULATION = False"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) AS ca_s1_2021 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE SUBSTR(DATE_TICKET, 4, 2) IN ('01', '02', '03', '04', '05', '06') AND SUBSTR(DATE_TICKET, 7, 4) = '2021' AND ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ,           0.0,         0.0, False    , True
Quel est le CA du T1 2022 ?                                                                                                                                                                                , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) as ca_t1_2022 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE SUBSTR(DATE_TICKET, 4, 2) IN ('01', '02', '03') AND SUBSTR(DATE_TICKET, 7, 4) = '2022' AND ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) AS ca_t1_2022 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE SUBSTR(DATE_TICKET, 4, 2) IN ('01', '02', '03') AND SUBSTR(DATE_TICKET, 7, 4) = '2022' AND ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaires journalier moyen de juillet 21?                                                                                                                                             , "WITH ca_journalier_juillet_2021 AS ( SELECT PARSE_DATE('%d/%m/%Y', DATE_TICKET) as DATE_TICKET , SUM(PRIX_AP_REMISE * QUANTITE) AS ca_journalier FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` WHERE PARSE_DATE('%d/%m/%Y', DATE_TICKET) between ""2021-07-01"" AND ""2021-07-31"" GROUP BY DATE_TICKET) Select avg(ca_journalier) as ca_journalier_moyen_juillet_2021 from ca_journalier_juillet_2021"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              , INCOMPLETE_SCHEMA                                                                                        , "SELECT AVG(ca_par_jour) AS ca_journalier_moyen_juillet_2021 FROM ( SELECT PARSE_DATE('%d/%m/%Y', DATE_TICKET) AS DATE_TICKET, SUM(PRIX_AP_REMISE * QUANTITE) AS ca_par_jour FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE PARSE_DATE('%d/%m/%Y', DATE_TICKET) BETWEEN '2021-07-01' AND '2021-07-31' GROUP BY DATE_TICKET ) AS ca_journalier"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaires total de l'entreprise ?                                                                                                                                                     , SELECT SUM(PRIX_AP_REMISE * QUANTITE) FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE ANNULATION = False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , SELECT SUM(PRIX_AP_REMISE * QUANTITE) AS ca_total FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE ANNULATION = False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ,           0.0,         0.0, False    , True
Quel est le CA total depuis le début de l'activité ?                                                                                                                                                       , SELECT SUM(PRIX_AP_REMISE * QUANTITE) AS ca_total FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE ANNULATION = False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                , INCOMPLETE_SCHEMA                                                                                        , SELECT SUM(PRIX_AP_REMISE * QUANTITE) AS ca_total FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE ANNULATION = False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ,           0.0,         0.0, False    , True
Quel a été le CA total pour l'année 2023 ?                                                                                                                                                                 , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE SUBSTR(DATE_TICKET, 7, 4) = '2023' AND ANNULATION = False"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) AS ca_total_2023 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE SUBSTR(DATE_TICKET, 7, 4) = '2023' AND ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ,           0.0,         0.0, False    , True
Quel est le jour de l'année avec le plus haut chiffre d'affaires moyen depuis le début ?                                                                                                                   , "WITH DailyRevenue AS (SELECT PARSE_DATE('%d/%m/%Y', DATE_TICKET) AS sale_date, SUM(PRIX_AP_REMISE * QUANTITE) AS total_revenue FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` WHERE ANNULATION = FALSE GROUP BY sale_date), DailyRevenueWithDayOfYear AS (SELECT FORMAT_DATE('%d%m', sale_date) as day_of_year_str, sale_date, total_revenue FROM DailyRevenue) SELECT day_of_year_str, AVG(total_revenue) AS avg_revenue FROM DailyRevenueWithDayOfYear GROUP BY day_of_year_str ORDER BY avg_revenue DESC LIMIT 1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  , INCOMPLETE_SCHEMA                                                                                        , "WITH DailyRevenue AS ( SELECT PARSE_DATE('%d/%m/%Y', DATE_TICKET) AS sale_date, SUM(PRIX_AP_REMISE * QUANTITE) AS total_revenue FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` WHERE ANNULATION = False GROUP BY sale_date ), DailyRevenueWithDayOfYear AS ( SELECT FORMAT_DATE('%d%m', sale_date) AS day_of_year, sale_date, total_revenue FROM DailyRevenue ) SELECT day_of_year, AVG(total_revenue) AS avg_revenue FROM DailyRevenueWithDayOfYear GROUP BY day_of_year ORDER BY avg_revenue DESC LIMIT 1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ,           0.0,         0.0, False    , True
Compare le chiffre d'affaires des magasins de centre-ville et des magasins de périphérie.                                                                                                                  , "SELECT m.CENTRE_VILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc LEFT JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE NOT m.CENTRE_VILLE IS NULL GROUP BY m.CENTRE_VILLE"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       , INCOMPLETE_SCHEMA                                                                                        , "SELECT m.CENTRE_VILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE m.TYPE_MAGASIN = 'Succursale' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.CENTRE_VILLE"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ,           0.0,         0.0, False    , True
Y a-t-il une tendance saisonnière dans les ventes de maillots de bain ?                                                                                                                                    , "WITH VentesMaillotsParMois AS ( SELECT CAST(SUBSTR(tc.DATE_TICKET, 4, 2) AS INT64) AS mois, SUM(tc.QUANTITE) AS total_ventes FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.LIGNE = 'Bain' GROUP BY mois ) SELECT mois, total_ventes, AVG(total_ventes) OVER (ORDER BY mois ASC ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS moyenne_mobile FROM VentesMaillotsParMois ORDER BY mois;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         , INCOMPLETE_SCHEMA                                                                                        , "WITH VentesMaillotsParMois AS ( SELECT PARSE_DATE('%d/%m/%Y', tc.DATE_TICKET) AS DATE_TICKET, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_Maillots FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Maillots de bain' AND tc.ANNULATION = False GROUP BY DATE_TICKET ), CA_MaillotsParMois AS ( SELECT FORMAT_DATE('%Y-%m', vm.DATE_TICKET) AS mois, SUM(vm.CA_Maillots) AS CA_Maillots FROM VentesMaillotsParMois AS vm GROUP BY mois ) SELECT mois, CA_Maillots, AVG(CA_Maillots) OVER (ORDER BY mois ASC ROWS BETWEEN 11 PRECEDING AND CURRENT) AS CA_MoyenneMobile FROM CA_MaillotsParMois ORDER BY mois;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ,           0.0,         0.0, False    , False
Quelle est la contribution au chiffre d'affaire des 10% des meilleurs clients?                                                                                                                             , "WITH ClientCA AS ( SELECT tc.ID_INDIVIDU, AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_moyen_transaction FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc WHERE tc.ANNULATION = FALSE GROUP BY tc.ID_INDIVIDU ), Top10PercentClients AS ( SELECT ID_INDIVIDU, CA_moyen_transaction, PERCENT_RANK() OVER (ORDER BY CA_moyen_transaction DESC) AS percentile FROM ClientCA ) SELECT SUM(CASE WHEN percentile <= 0.1 THEN 1 ELSE 0 END) AS nombre_clients_top_10, SUM(CASE WHEN percentile <= 0.1 THEN CA_moyen_transaction ELSE 0 END) AS CA_total_top_10, SUM(CA_moyen_transaction) AS CA_total, ROUND(SUM(CASE WHEN percentile <= 0.1 THEN CA_moyen_transaction ELSE 0 END) * 100.0 / SUM(CA_moyen_transaction),2) AS pourcentage_CA_top_10 FROM Top10PercentClients;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              , INCOMPLETE_SCHEMA                                                                                        , "WITH ClientCA AS ( SELECT tc.ID_INDIVIDU, AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_moyen_transaction FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc WHERE tc.ANNULATION = False GROUP BY tc.ID_INDIVIDU ), Top10PercentClients AS ( SELECT ID_INDIVIDU, CA_moyen_transaction, PERCENT_RANK() OVER (ORDER BY CA_moyen_transaction DESC) AS percentile FROM ClientCA ) SELECT SUM(CASE WHEN percentile <= 0.1 THEN 1 ELSE 0 END) AS nombre_clients_top_10, SUM(CASE WHEN percentile <= 0.1 THEN CA_moyen_transaction ELSE 0 END) AS CA_total_top_10, SUM(CA_moyen_transaction) AS CA_total, ROUND(SUM(CASE WHEN percentile <= 0.1 THEN CA_moyen_transaction ELSE 0 END) * 100.0 / SUM(CA_moyen_transaction), 2) AS pourcentage_CA_top_10 FROM Top10PercentClients;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaires moyen par transaction ?                                                                                                                                                     , SELECT AVG(PRIX_AP_REMISE * QUANTITE) AS ca_moyen FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE ANNULATION = False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                , INCOMPLETE_SCHEMA                                                                                        , SELECT AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_moyen FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc WHERE tc.ANNULATION = False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,           0.0,         0.0, False    , True
Quel magasin a généré le plus de chiffre d'affaires en 2023 ?                                                                                                                                              , "SELECT m.VILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as ca_total FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.VILLE ORDER BY ca_total DESC LIMIT 1;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         , INCOMPLETE_SCHEMA                                                                                        , "SELECT m.VILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_total FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.VILLE ORDER BY ca_total DESC LIMIT 1;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ,           0.0,         0.0, False    , True
Quelle région a la plus forte croissance de chiffre d'affaires entre 2022 et 2023 ?                                                                                                                        , "WITH CA_2022 AS ( SELECT m.REGIONS, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as ca_2022 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE SUBSTR(tc.DATE_TICKET, 7, 4) = '2022' AND tc.ANNULATION = False GROUP BY m.REGIONS ), CA_2023 AS ( SELECT m.REGIONS, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as ca_2023 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS ) SELECT ca23.REGIONS, ca23.ca_2023, ca22.ca_2022, ROUND((ca23.ca_2023 - ca22.ca_2022) * 100.0 / ca22.ca_2022, 2) as taux_croissance FROM CA_2023 ca23 JOIN CA_2022 ca22 ON ca23.REGIONS = ca22.REGIONS ORDER BY taux_croissance DESC LIMIT 1;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               , INCOMPLETE_SCHEMA                                                                                        , "WITH CA_2022 AS ( SELECT m.REGIONS, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_2022 FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE SUBSTR(tc.DATE_TICKET, 7, 4) = '2022' AND tc.ANNULATION = False GROUP BY m.REGIONS ), CA_2023 AS ( SELECT m.REGIONS, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_2023 FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS ) SELECT ca23.REGIONS, ca23.ca_2023, ca22.ca_2022, ROUND((ca23.ca_2023 - ca22.ca_2022) * 100.0 / ca22.ca_2022, 2) AS taux_croissance FROM CA_2023 AS ca23 JOIN CA_2022 AS ca22 ON ca23.REGIONS = ca22.REGIONS ORDER BY taux_croissance DESC LIMIT 1;"                                                                                                                                                                                                                                                                                                                                                                                                     ,           0.0,         0.0, False    , True
Quel est le manager avec le plus de consultant?                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quel est le chiffre d'affaires journalier moyen en juillet 2020 ?                                                                                                                                          , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , "SELECT AVG(ca_par_jour) AS ca_journalier_moyen_juillet_2020 FROM ( SELECT PARSE_DATE('%d/%m/%Y', DATE_TICKET) AS DATE_TICKET, SUM(PRIX_AP_REMISE * QUANTITE) AS ca_par_jour FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` WHERE PARSE_DATE('%d/%m/%Y', DATE_TICKET) BETWEEN '2020-07-01' AND '2020-07-31' GROUP BY DATE_TICKET ) AS ca_journalier"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaires journalier moyen en juillet 2023 ?                                                                                                                                          , "SELECT AVG(ca_par_jour) AS ca_journalier_moyen_juillet_2023 FROM ( SELECT PARSE_DATE('%d/%m/%Y', DATE_TICKET) AS DATE_TICKET, SUM(PRIX_AP_REMISE * QUANTITE) AS ca_par_jour FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` WHERE DATE_TRUNC(PARSE_DATE('%d/%m/%Y', DATE_TICKET), MONTH) = '2023-07-01' GROUP BY DATE_TICKET ) AS ca_journalier"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       , INCOMPLETE_SCHEMA                                                                                        , "SELECT AVG(ca_par_jour) AS ca_journalier_moyen_juillet_2023 FROM ( SELECT PARSE_DATE('%d/%m/%Y', DATE_TICKET) AS DATE_TICKET, SUM(PRIX_AP_REMISE * QUANTITE) AS ca_par_jour FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` WHERE PARSE_DATE('%d/%m/%Y', DATE_TICKET) BETWEEN '2023-07-01' AND '2023-07-31' GROUP BY DATE_TICKET ) AS ca_journalier"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaires généré par les Maillots de bain 1 pièce en 2023 ?                                                                                                                           , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_maillots_2023 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Maillots de bain 1 pièce' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ,           0.0,         0.0, False    , True
CA 2024 ?                                                                                                                                                                                                  , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quel est le prix de vente moyen des maillots de bain ?                                                                                                                                                     , SELECT AVG(tc.PRIX_AP_REMISE) AS prix_moyen FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Bain_Maillot' AND tc.ANNULATION = False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   , INCOMPLETE_SCHEMA                                                                                        , SELECT AVG(tc.PRIX_AP_REMISE) AS prix_moyen FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Maillots de bain' AND tc.ANNULATION = False;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ,           0.0,         0.0, False    , True
Age moyen clients ?                                                                                                                                                                                        , "SELECT AVG(CAST(SUBSTR(CAST(CURRENT_DATE() as STRING),1,4) as BIGNUMERIC)-CAST(DATE_NAISS_A as BIGNUMERIC)) AS age_moyen FROM avisia-self-service-analytics.reine_des_maracas.individu"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                        , "SELECT AVG(CAST(SUBSTR(CAST(CURRENT_DATE() as STRING),1,4) as BIGNUMERIC)-CAST(i.DATE_NAISS_A as BIGNUMERIC)) AS age_moyen FROM `avisia-self-service-analytics.reine_des_maracas.individu` AS i"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , True
Quelles sont les 5 familles de produits les plus vendues en termes de chiffre d'affaires ?                                                                                                                 , "SELECT tp.FAMILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS total_ca FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tc.ANNULATION = FALSE GROUP BY tp.FAMILLE ORDER BY total_ca DESC LIMIT 5;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    , INCOMPLETE_SCHEMA                                                                                        , "SELECT tp.FAMILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tc.ANNULATION = False GROUP BY tp.FAMILLE ORDER BY CA DESC LIMIT 5;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ,           0.0,         0.0, False    , True
Quel est le prix de vente moyen des Slips ?                                                                                                                                                                , SELECT AVG(tc.PRIX_AP_REMISE) AS prix_moyen FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Slip'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                        , SELECT AVG(tc.PRIX_AP_REMISE) AS prix_moyen FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Slips' AND tc.ANNULATION = False;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ,           0.0,         0.0, False    , True
Nombre de clients à Paris?                                                                                                                                                                                 , SELECT COUNT(DISTINCT tc.ID_INDIVIDU) AS total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc INNER JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE m.REGIONS = 'Paris'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          , INCOMPLETE_SCHEMA                                                                                        , SELECT COUNT(DISTINCT tc.ID_INDIVIDU) AS total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE UPPER(m.VILLE) LIKE '%PARIS%'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ,           0.0,         0.0, False    , True
Peux-tu me dire sur ces clients le montant moyen qu'ils dépensent ?                                                                                                                                        , SELECT AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS depense_moyenne FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc WHERE tc.ANNULATION = FALSE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             , INCOMPLETE_SCHEMA                                                                                        , SELECT AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS depense_moyenne FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc WHERE tc.ANNULATION = False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ,           0.0,         0.0, False    , True
Les magasins de centre-ville à Paris performent bien. Quelle est la répartition par âge des clients qui achètent des maillots de bain dans ces magasins ?                                                  , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Bain_Maillot' AND m.REGIONS = 'Paris' AND m.CENTRE_VILLE IN ('Centre Ville', 'Centre ville') AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         , INCOMPLETE_SCHEMA                                                                                        , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Maillots de bain' AND m.VILLE = 'Paris' AND m.CENTRE_VILLE = 'Oui' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                                   ,           0.0,         0.0, False    , True
Les magasins de centre-ville à Paris performent bien. Quelle est la répartition par âge des clients qui achètent des maillots de bain dans ces magasins ?                                                  , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Bain_Maillot' AND m.REGIONS = 'Paris' AND m.CENTRE_VILLE IN ('Centre Ville', 'Centre ville') AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   , INCOMPLETE_SCHEMA                                                                                        , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Maillots de bain' AND m.VILLE = 'Paris' AND m.CENTRE_VILLE = 'Oui' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                                   ,           0.0,         0.0, False    , True
Les magasins succursale en province performent bien. Quelle est la répartition par âge des clients qui achètent des maillots de bain dans ces magasins?                                                    , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Bain_Maillot' AND m.REGIONS = 'Province' AND m.TYPE_MAGASIN = 'Succursale' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           , INCOMPLETE_SCHEMA                                                                                        , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Maillots de bain' AND m.REGIONS <> 'Île-de-France' AND m.TYPE_MAGASIN = 'Succursale' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                 ,           0.0,         0.0, False    , True
Les magasins succursale en province performent bien. Quelle est la répartition par âge des clients qui achètent des maillots de bain dans ces magasins ?                                                   , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Bain_Maillot' AND m.REGIONS = 'Province' AND m.TYPE_MAGASIN = 'Succursale' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           , INCOMPLETE_SCHEMA                                                                                        , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Maillots de bain' AND m.REGIONS <> 'Île-de-France' AND m.TYPE_MAGASIN = 'Succursale' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                 ,           0.0,         0.0, False    , True
Les magasins succursale en province performent bien. Quelle est la répartition par âge des clients qui achètent des maillots de bain dans ces magasins ?                                                   , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Bain_Maillot' AND m.REGIONS = 'Province' AND m.TYPE_MAGASIN = 'Succursale' AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                        , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Maillots de bain' AND m.REGIONS <> 'Île-de-France' AND m.TYPE_MAGASIN = 'Succursale' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                 ,           0.0,         0.0, False    , True
"Les magasins succursale en province performent bien, quelle est la répartition par âge des clients qui achètent des maillots de bains dans ces magasins?"                                                 , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Bain_Maillot' AND m.REGIONS = 'Province' AND m.TYPE_MAGASIN = 'Succursale' AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                        , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Maillots de bain' AND m.REGIONS <> 'Île-de-France' AND m.TYPE_MAGASIN = 'Succursale' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                 ,           0.0,         0.0, False    , True
Les magasins succursale en province performent bien. Quelle est la répartition par âge des clients qui achètent des maillots de bain dans ces magasins?                                                    , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Bain_Maillot' AND m.REGIONS = 'Province' AND m.TYPE_MAGASIN = 'Succursale' GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               , INCOMPLETE_SCHEMA                                                                                        , "SELECT CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, COUNT(DISTINCT tc.ID_INDIVIDU) as nombre_clients FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.FAMILLE = 'Maillots de bain' AND m.REGIONS <> 'Île-de-France' AND m.TYPE_MAGASIN = 'Succursale' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tranche_age ORDER BY tranche_age;"                                                                                                                                                                                                                                                                                 ,           0.0,         0.0, False    , True
Combien de magasins avons-nous à Paris ?                                                                                                                                                                   , SELECT COUNT(*) AS total FROM `avisia-self-service-analytics.reine_des_maracas.magasin` AS t1 WHERE t1.REGIONS = 'Paris'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                        , SELECT COUNT(DISTINCT CODE_BOUTIQUE) AS total FROM `avisia-self-service-analytics.reine_des_maracas.magasin` WHERE UPPER(VILLE) LIKE '%PARIS%'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,           0.0,         0.0, False    , True
Quel est le nombre total de clients dans notre base ?                                                                                                                                                      , SELECT COUNT(*) AS total FROM avisia-self-service-analytics.reine_des_maracas.individu                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       , INCOMPLETE_SCHEMA                                                                                        , SELECT COUNT(DISTINCT ID_INDIVIDU) AS total FROM avisia-self-service-analytics.reine_des_maracas.individu                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ,           0.0,         0.0, False    , True
Combien avons de clients ?                                                                                                                                                                                 , SELECT COUNT(DISTINCT ID_INDIVIDU) AS total FROM avisia-self-service-analytics.reine_des_maracas.individu                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    , SELECT COUNT(DISTINCT ID_INDIVIDU) AS total FROM avisia-self-service-analytics.reine_des_maracas.individu, SELECT COUNT(DISTINCT ID_INDIVIDU) AS total FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ,           0.0,         0.0, True     , True
Quel est el jour avec le plus d'achats ?                                                                                                                                                                   , "SELECT EXTRACT(DAYOFWEEK FROM PARSE_DATE('%d/%m/%Y', DATE_TICKET)) AS jour, COUNT(*) AS total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` GROUP BY jour ORDER BY total DESC LIMIT 1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               , INCOMPLETE_SCHEMA                                                                                        , "SELECT FORMAT_DATE('%A', PARSE_DATE('%d/%m/%Y', DATE_TICKET)) AS jour, COUNT(*) AS total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` GROUP BY jour ORDER BY total DESC LIMIT 1"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ,           0.0,         0.0, False    , True
Donne moi maintenant l'évolution du chiffre d'affaires total par année                                                                                                                                     , "SELECT SUBSTR(DATE_TICKET, 7, 4) AS annee, SUM(PRIX_AP_REMISE * QUANTITE) AS ca_total FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE ANNULATION = False GROUP BY annee ORDER BY annee"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUBSTR(tc.DATE_TICKET, 7, 4) AS annee, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc WHERE tc.ANNULATION = False GROUP BY annee ORDER BY annee;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ,           0.0,         0.0, False    , True
chiffre d'affaires par an                                                                                                                                                                                  , "SELECT SUBSTR(DATE_TICKET, 7, 4) AS annee, SUM(PRIX_AP_REMISE * QUANTITE) AS ca_total FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE ANNULATION = False GROUP BY annee ORDER BY annee;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUBSTR(DATE_TICKET, 7, 4) AS annee, SUM(PRIX_AP_REMISE * QUANTITE) AS ca FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE ANNULATION = False GROUP BY annee ORDER BY annee;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaire sur les maillots de bain par année                                                                                                                                           , "SELECT SUBSTR(tc.DATE_TICKET, 7, 4) AS annee, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS chiffre_affaire FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Bain_Maillot' AND tc.ANNULATION = False GROUP BY annee ORDER BY annee;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUBSTR(tc.DATE_TICKET, 7, 4) AS annee, m.VILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS chiffre_affaire FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Maillots de bain' AND tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ,           0.0,         0.0, False    , True
Quel est le CA par an                                                                                                                                                                                      , "SELECT SUBSTR(tc.DATE_TICKET, 7, 4) AS annee, m.VILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc LEFT JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUBSTR(tc.DATE_TICKET, 7, 4) AS annee, m.VILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc LEFT JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaires total de l'année 2022 ?                                                                                                                                                     , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE SUBSTR(DATE_TICKET, 7, 4) = '2022' AND ANNULATION = False"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE SUBSTR(DATE_TICKET, 7, 4) = '2022' AND ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaires total de l'année 2022 ?                                                                                                                                                     , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) as ca_total_2022 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE SUBSTR(DATE_TICKET, 7, 4) = '2022' AND ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE SUBSTR(DATE_TICKET, 7, 4) = '2022' AND ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaires total réalisé sur les maillots de bain en 2023 ?                                                                                                                            , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_maillots_2023 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Bain_Maillot' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Maillots de bain' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ,           0.0,         0.0, False    , True
Quel est le CA des maillots de bain en 2023 ?                                                                                                                                                              , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_maillots_2023 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Bain_Maillot' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_maillots_2023 FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Maillots de bain' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaires total réalisé sur les maillots de bain en 2023 ?                                                                                                                            , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Bain_Maillot' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Maillots de bain' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaires total réalisé sur les maillots de bain en 2023 ?                                                                                                                            , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Bain_Maillot' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Maillots de bain' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaires total réalisé sur les maillots de bain en 2023 ?                                                                                                                            , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Bain_Maillot' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_total FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Maillots de bain' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ,           0.0,         0.0, False    , True
Quel est le chiffre d'affaires total réalisé sur les maillots de bain en 2023 ?                                                                                                                            , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_total FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.LIGNE = 'Bain' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   , INCOMPLETE_SCHEMA                                                                                        , "SELECT SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Maillots de bain' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ,           0.0,         0.0, False    , True
Donne moi le volume de produits vendus par magasin sur 2023                                                                                                                                                , "SELECT m.CODE_BOUTIQUE, m.VILLE, SUM(tc.QUANTITE) AS VOLUME_VENTES FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' GROUP BY m.CODE_BOUTIQUE, m.VILLE;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           , INCOMPLETE_SCHEMA                                                                                        , "SELECT m.VILLE, SUM(tc.QUANTITE) AS VOLUME_VENTES FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.VILLE ORDER BY VOLUME_VENTES DESC;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ,           0.0,         0.0, False    , True
Quelle est la répartition de ce CA par région et par type de magasin ?                                                                                                                                     , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Bain_Maillot' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS, m.TYPE_MAGASIN ORDER BY m.REGIONS, m.TYPE_MAGASIN;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                        , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Vêtements' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS, m.TYPE_MAGASIN ORDER BY m.REGIONS, m.TYPE_MAGASIN;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ,           0.0,         0.0, False    , True
Quel est la répartition du CA par région et type de magasin ?                                                                                                                                              , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_Total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Bain_Maillot' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' GROUP BY m.REGIONS, m.TYPE_MAGASIN"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             , INCOMPLETE_SCHEMA                                                                                        , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Vêtements' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS, m.TYPE_MAGASIN ORDER BY m.REGIONS, m.TYPE_MAGASIN;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ,           0.0,         0.0, False    , True
Quelle est la répartition de ce CA par région et par type de magasin?                                                                                                                                      , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Bain_Maillot' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS, m.TYPE_MAGASIN ORDER BY m.REGIONS, m.TYPE_MAGASIN;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               , INCOMPLETE_SCHEMA                                                                                        , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Vêtements' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS, m.TYPE_MAGASIN ORDER BY m.REGIONS, m.TYPE_MAGASIN;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ,           0.0,         0.0, False    , True
Quelle est la répartition de ce CA par région et par type de magasin ?                                                                                                                                     , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Bain_Maillot' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS, m.TYPE_MAGASIN ORDER BY m.REGIONS, m.TYPE_MAGASIN;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               , INCOMPLETE_SCHEMA                                                                                        , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Vêtements' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS, m.TYPE_MAGASIN ORDER BY m.REGIONS, m.TYPE_MAGASIN;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ,           0.0,         0.0, False    , True
Quelle est la répartition de ce CA par région et par type de magasin?                                                                                                                                      , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.LIGNE = 'Bain' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS, m.TYPE_MAGASIN ORDER BY m.REGIONS, m.TYPE_MAGASIN;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         , INCOMPLETE_SCHEMA                                                                                        , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Vêtements' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS, m.TYPE_MAGASIN ORDER BY m.REGIONS, m.TYPE_MAGASIN;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ,           0.0,         0.0, False    , True
quelles sont les top 5 des magasins qui ont vendu le plus de produits en 2023 ?                                                                                                                            , "SELECT m.VILLE, SUM(tc.QUANTITE) AS total_ventes FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.VILLE ORDER BY total_ventes DESC LIMIT 5;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           , INCOMPLETE_SCHEMA                                                                                        , "SELECT m.VILLE, SUM(tc.QUANTITE) AS total_ventes FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.VILLE ORDER BY total_ventes DESC LIMIT 5;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ,           0.0,         0.0, False    , True
"Toujours pour les mêmes magasins et les mêmes tranches d'âges, quelles sont les familles de maillots de bain qui se vendent le mieux ?"                                                                   , "SELECT tp.FAMILLE, CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as chiffre_affaires FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN `avisia-self-service-analytics.reine_des_maracas.individu` AS i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.LIGNE = 'Bain' AND m.REGIONS = 'Province' AND m.TYPE_MAGASIN = 'Succursale' AND tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 , INCOMPLETE_SCHEMA                                                                                        , "SELECT tp.FAMILLE, CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as chiffre_affaires FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.LIGNE = 'Maillots de bain' AND m.TYPE_MAGASIN = 'Succursale' AND m.REGIONS = 'Ile-de-France' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2;"                                                                                                                                                                                                                                                                              ,           0.0,         0.0, False    , True
"Toujours pour les mêmes magasins et les mêmes tranches d'âges, quelles sont les familles de maillots de bain qui se vendent le mieux?"                                                                    , "SELECT tp.FAMILLE, CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as chiffre_affaires FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.LIGNE = 'Bain' AND m.REGIONS = 'Province' AND m.TYPE_MAGASIN = 'Succursale' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                , INCOMPLETE_SCHEMA                                                                                        , "SELECT tp.FAMILLE, CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as CA FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.LIGNE = 'Maillots de bain' AND m.TYPE_MAGASIN = 'Succursale' AND m.REGIONS = 'Ile-de-France' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2;"                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , True
"Toujours pour les mêmes magasins et les mêmes tranches d'âges, quelles sont les familles de maillots de bain qui se vendent le mieux?"                                                                    , "SELECT tp.FAMILLE, CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as chiffre_affaires FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.LIGNE = 'Bain' AND m.REGIONS = 'Province' AND m.TYPE_MAGASIN = 'Succursale' AND tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         , INCOMPLETE_SCHEMA                                                                                        , "SELECT tp.FAMILLE, CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as chiffre_affaire FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.LIGNE = 'Maillots de bain' AND m.REGIONS = 'Auvergne-Rhône-Alpes' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2;"                                                                                                                                                                                                                                                                                                          ,           0.0,         0.0, False    , True
"Toujours pour les mêmes magasins et les mêmes tranches d'âges, quelles sont les familles de maillots de bain qui se vendent le mieux ?"                                                                   , "SELECT tp.FAMILLE, CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as chiffre_affaires FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.LIGNE = 'Bain' AND m.REGIONS = 'Province' AND m.TYPE_MAGASIN = 'Succursale' AND tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         , INCOMPLETE_SCHEMA                                                                                        , "SELECT tp.FAMILLE, CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as chiffre_affaires FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.LIGNE = 'Maillots de bain' AND m.TYPE_MAGASIN = 'Succursale' AND m.REGIONS = 'Ile-de-France' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2;"                                                                                                                                                                                                                                                                              ,           0.0,         0.0, False    , True
"Toujours pour les mêmes magasins et les mêmes tranches d'âges, quelles sont les familles de maillots de bain qui se vendent le mieux?"                                                                    , "SELECT tp.FAMILLE, CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as chiffre_affaires FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.LIGNE = 'Maillots' AND m.REGIONS = 'Province' AND m.TYPE_MAGASIN = 'Succursale' AND tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                        , "SELECT tp.FAMILLE, CASE WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 25 THEN '18-24' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 35 THEN '25-34' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 45 THEN '35-44' WHEN CAST(2024 - CAST(i.DATE_NAISS_A as INT64) as INT64) < 55 THEN '45-54' ELSE '55+' END as tranche_age, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) as CA FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE JOIN avisia-self-service-analytics.reine_des_maracas.individu i ON tc.ID_INDIVIDU = i.ID_INDIVIDU WHERE tp.LIGNE = 'Maillots de bain' AND m.REGIONS = 'Auvergne-Rhône-Alpes' AND m.TYPE_MAGASIN = 'Succursale' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY 1, 2 ORDER BY 1, 2;"                                                                                                                                                                                                                                                                                     ,           0.0,         0.0, False    , True
"Donen moi la répartition du chiffre d'affaire par famille de produit pour le magasin ""LA DEFENSE"""                                                                                                      , "SELECT tp.FAMILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE m.VILLE = 'LA DEFENSE' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tp.FAMILLE"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                , INCOMPLETE_SCHEMA                                                                                        , "SELECT tp.FAMILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE m.VILLE = 'LA DEFENSE' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tp.FAMILLE ORDER BY CA DESC;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ,           0.0,         0.0, False    , True
"super, détailles moi les chiffres de 2022 par famille de produits"                                                                                                                                        , "SELECT tp.FAMILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_2022 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.LIGNE = 'Bain' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2022' AND tc.ANNULATION = False GROUP BY tp.FAMILLE"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                        , "SELECT tp.FAMILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_2022 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.LIGNE = 'Textile' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2022' AND tc.ANNULATION = False GROUP BY tp.FAMILLE ORDER BY CA_2022 DESC;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ,           0.0,         0.0, False    , True
"Donen moi la répartition du chiffre d'affaire par famille de produit pour le magasin ""LA DEFENSE"""                                                                                                      , "SELECT tp.FAMILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_Famille FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE JOIN avisia-self-service-analytics.reine_des_maracas.magasin m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE m.VILLE = 'LA DEFENSE' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tp.FAMILLE ORDER BY CA_Famille DESC;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              , INCOMPLETE_SCHEMA                                                                                        , "SELECT tp.FAMILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE m.VILLE = 'LA DEFENSE' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tp.FAMILLE ORDER BY CA DESC;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ,           0.0,         0.0, False    , True
Peux tu me faire une répartition du CA dépensé par famille de produit ?                                                                                                                                    , "SELECT tp.FAMILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_total FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse tc JOIN avisia-self-service-analytics.reine_des_maracas.referentiel ref ON tc.EAN = ref.EAN JOIN avisia-self-service-analytics.reine_des_maracas.typo_produit tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tc.ANNULATION = FALSE GROUP BY tp.FAMILLE ORDER BY CA_total DESC;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , "SELECT tp.FAMILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tc.ANNULATION = False GROUP BY tp.FAMILLE ORDER BY CA DESC;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ,           0.0,         0.0, False    , True
et quelle est la différence cumulée entre les deux sur l'ensemble de l'année 2023 ?                                                                                                                        , "WITH CA_Paris_CentreVille AS ( SELECT tc.ID_INDIVIDU, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_Total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.LIGNE = 'Bain' AND m.VILLE = 'Paris' AND m.CENTRE_VILLE IN ('Centre Ville', 'Centre ville') AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tc.ID_INDIVIDU ), CA_Total_Paris_CentreVille AS ( SELECT AVG(CA_Total) AS CA_Moyen_Paris_CentreVille FROM CA_Paris_CentreVille ), CA_Tous_Clients AS ( SELECT tc.ID_INDIVIDU, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_Total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.LIGNE = 'Bain' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY tc.ID_INDIVIDU ), CA_Moyen_Tous_Clients AS ( SELECT AVG(CA_Total) AS CA_Moyen_Tous FROM CA_Tous_Clients ) SELECT t1.CA_Moyen_Paris_CentreVille - t2.CA_Moyen_Tous AS Difference_CA_Moyen FROM CA_Total_Paris_CentreVille AS t1, CA_Moyen_Tous_Clients AS t2"                                                                   , INCOMPLETE_SCHEMA                                                                                        , "WITH CA_Magasins AS ( SELECT m.CODE_BOUTIQUE, m.VILLE, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_2023 FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.CODE_BOUTIQUE, m.VILLE ), CA_Magasins_Paris AS ( SELECT CODE_BOUTIQUE, VILLE, CA_2023 FROM CA_Magasins WHERE LOWER(VILLE) LIKE '%paris%' ), CA_Magasins_Non_Paris AS ( SELECT CODE_BOUTIQUE, VILLE, CA_2023 FROM CA_Magasins WHERE LOWER(VILLE) NOT LIKE '%paris%' ) SELECT SUM(CASE WHEN tmp.VILLE LIKE '%paris%' THEN tmp.CA_2023 ELSE -tmp.CA_2023 END) AS difference_ca_paris_vs_non_paris FROM ( SELECT cmp.CODE_BOUTIQUE, cmp.VILLE, cmp.CA_2023 FROM CA_Magasins_Paris cmp UNION ALL SELECT cmnp.CODE_BOUTIQUE, cmnp.VILLE, cmnp.CA_2023 FROM CA_Magasins_Non_Paris cmnp ) AS tmp;"                                                                                                                                                                                                                                                                                                                                                                                                                     ,           0.0,         0.0, False    , True
"Quel est le CA moyen que ces clients réalisent, versus le CA moyen de l'ensemble des clients ?"                                                                                                           , "WITH ClientsMaillots AS ( SELECT DISTINCT tc.ID_INDIVIDU FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Bain_Maillot' ), ClientsMaillotsParisCentreVille AS ( SELECT DISTINCT tc.ID_INDIVIDU FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Bain_Maillot' AND m.REGIONS = 'Paris' AND m.CENTRE_VILLE IN ('Centre Ville', 'Centre ville') ), CaMoyenClients AS ( SELECT AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CaMoyen FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN ClientsMaillots AS cm ON tc.ID_INDIVIDU = cm.ID_INDIVIDU ), CaMoyenClientsParisCentreVille AS ( SELECT AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CaMoyenParisCentreVille FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN ClientsMaillotsParisCentreVille AS cmpcv ON tc.ID_INDIVIDU = cmpcv.ID_INDIVIDU ) SELECT (SELECT CaMoyenParisCentreVille FROM CaMoyenClientsParisCentreVille) AS CaMoyenParisCentreVille, (SELECT CaMoyen FROM CaMoyenClients) AS CaMoyenTousClients", INCOMPLETE_SCHEMA                                                                                        , "WITH Clients_Avisia AS ( SELECT DISTINCT tc.ID_INDIVIDU FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE m.REGIONS = 'Île-de-France' ), CA_Clients_Avisia AS ( SELECT tc.ID_INDIVIDU, AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_moyen_client_idf FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN Clients_Avisia AS ca ON tc.ID_INDIVIDU = ca.ID_INDIVIDU GROUP BY tc.ID_INDIVIDU ), CA_Tous_Clients AS ( SELECT tc.ID_INDIVIDU, AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_moyen_tous_clients FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc GROUP BY tc.ID_INDIVIDU ) SELECT (SELECT AVG(CA_moyen_client_idf) FROM CA_Clients_Avisia) AS CA_moyen_clients_idf, (SELECT AVG(CA_moyen_tous_clients) FROM CA_Tous_Clients) AS CA_moyen_tous_clients"                                                                                                                                                                                                                                                                                                                                                                                                                                   ,           0.0,         0.0, False    , True
Quel est le CA moyen que réalisent ceux qui achètent des maillots versus le CA moyen de l'ensemble des clients ?                                                                                           , "WITH ClientsMaillots AS ( SELECT DISTINCT tc.ID_INDIVIDU FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Bain_Maillot' ), CAParClient AS ( SELECT tc.ID_INDIVIDU, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_Total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` tc GROUP BY tc.ID_INDIVIDU ) SELECT ROUND(AVG(CASE WHEN cm.ID_INDIVIDU IS NOT NULL THEN cac.CA_Total ELSE NULL END), 2) AS CA_Moyen_Clients_Maillots, ROUND(AVG(cac.CA_Total), 2) AS CA_Moyen_Tous_Clients FROM CAParClient cac LEFT JOIN ClientsMaillots cm ON cac.ID_INDIVIDU = cm.ID_INDIVIDU"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                        , "WITH ClientsMaillots AS ( SELECT DISTINCT tc.ID_INDIVIDU FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` tp ON ref.ID_MODELE = tp.ID_MODELE WHERE tp.FAMILLE = 'Maillots' ), CAMoyenClientsMaillots AS ( SELECT AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_moyen_maillots FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` tc JOIN ClientsMaillots cm ON tc.ID_INDIVIDU = cm.ID_INDIVIDU ), CAMoyenTousClients AS ( SELECT AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_moyen_tous FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` tc ) SELECT (SELECT CA_moyen_maillots FROM CAMoyenClientsMaillots) AS CA_moyen_clients_maillots, (SELECT CA_moyen_tous FROM CAMoyenTousClients) AS CA_moyen_tous_clients;"                                                                                                                                                                                                                                                                                                                                                                                                                                                 ,           0.0,         0.0, False    , True
"Effectue une segmentation RFM (récence, fréquence, montant) sur les clients par rapport à leurs achat. Puis donne moi les volumes par groupes.

Ne met aucun commentaire dans le code SQL généré pour éviter tout erreur de syntaxe.
Et voici la fonction SQL à utiliser pour exploiter la variable DATE_TICKET : PARSE_DATE('%d/%m/%Y', DATE_TICKET)"                                                                                          , "WITH RFM AS ( SELECT ID_INDIVIDU, DATE_DIFF(CURRENT_DATE(), MAX(PARSE_DATE('%d/%m/%Y', DATE_TICKET)), DAY) AS Recence, COUNT(DISTINCT NUM_TICKET) AS Frequence, SUM(PRIX_AP_REMISE * QUANTITE) AS Montant FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` WHERE ANNULATION = False GROUP BY ID_INDIVIDU ), Quartiles AS ( SELECT ID_INDIVIDU, Recence, Frequence, Montant, NTILE(4) OVER (ORDER BY Recence DESC) AS R_Quartile, NTILE(4) OVER (ORDER BY Frequence) AS F_Quartile, NTILE(4) OVER (ORDER BY Montant) AS M_Quartile FROM RFM ) SELECT R_Quartile, F_Quartile, M_Quartile, COUNT(*) AS Nombre_Clients FROM Quartiles GROUP BY R_Quartile, F_Quartile, M_Quartile ORDER BY R_Quartile, F_Quartile, M_Quartile"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              , INCOMPLETE_SCHEMA                                                                                        , "WITH RFM AS ( SELECT ID_INDIVIDU, DATE_DIFF(CURRENT_DATE(), MAX(PARSE_DATE('%d/%m/%Y', DATE_TICKET)), DAY) AS Recence, COUNT(DISTINCT NUM_TICKET) AS Frequence, SUM(PRIX_AP_REMISE * QUANTITE) AS Montant FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` WHERE ANNULATION = False GROUP BY ID_INDIVIDU ), Quartiles AS ( SELECT ID_INDIVIDU, Recence, Frequence, Montant, NTILE(4) OVER (ORDER BY Recence DESC) AS R_Quartile, NTILE(4) OVER (ORDER BY Frequence) AS F_Quartile, NTILE(4) OVER (ORDER BY Montant) AS M_Quartile FROM RFM ) SELECT R_Quartile, F_Quartile, M_Quartile, COUNT(*) AS Nombre_Clients FROM Quartiles GROUP BY R_Quartile, F_Quartile, M_Quartile ORDER BY R_Quartile, F_Quartile, M_Quartile;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ,           0.0,         0.0, False    , True
par contre                                                                                                                                                                                                 , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quelles sont les donnes à disposition ?                                                                                                                                                                    , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Donne moi les 5 derniers consultants arrivés                                                                                                                                                               , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
quelles sont les top 5 des villes qui ont vendu le plus de produits en 2023 ?                                                                                                                              , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , "SELECT m.VILLE, SUM(tc.QUANTITE) AS total_ventes FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.VILLE ORDER BY total_ventes DESC LIMIT 5;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ,           0.0,         0.0, False    , True
l'affaire parents                                                                                                                                                                                          , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quel est le chiffre d'affaires total de l'année 2025 ?                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
donne-moi le chiffre d'affaire de l'année 2024                                                                                                                                                             , "SELECT SUM(PRIX_AP_REMISE * QUANTITE) as ca_total_2024 FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE SUBSTR(DATE_TICKET, 7, 4) = '2024' AND ANNULATION = False;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quelle est la répartition de ce CA par région et par type de magasin?                                                                                                                                      , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Bain_Maillot' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' GROUP BY m.REGIONS, m.TYPE_MAGASIN"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             , INCOMPLETE_SCHEMA                                                                                        , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Mode' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS, m.TYPE_MAGASIN ORDER BY m.REGIONS, m.TYPE_MAGASIN;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ,           0.0,         0.0, False    , True
Quelle est la répartition de ce CA par région et par type de magasin ?                                                                                                                                     , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.LIGNE = 'Bain' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = FALSE GROUP BY m.REGIONS, m.TYPE_MAGASIN ORDER BY m.REGIONS, m.TYPE_MAGASIN;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         , INCOMPLETE_SCHEMA                                                                                        , "SELECT m.REGIONS, m.TYPE_MAGASIN, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.referentiel` AS ref ON tc.EAN = ref.EAN JOIN `avisia-self-service-analytics.reine_des_maracas.typo_produit` AS tp ON ref.ID_MODELE = tp.ID_MODELE JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE tp.FAMILLE = 'Vêtements' AND SUBSTR(tc.DATE_TICKET, 7, 4) = '2023' AND tc.ANNULATION = False GROUP BY m.REGIONS, m.TYPE_MAGASIN ORDER BY m.REGIONS, m.TYPE_MAGASIN;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ,           0.0,         0.0, False    , True
"Quel est le taux de conversion par vendeur (nombre de tickets / nombre d'ID_INDIVIDU distincts gérés par ce vendeur, en supposant qu'un vendeur gère un client si il a fait un ticket avec lui) ?"        , "WITH VendeurClients AS (SELECT CODE_VENDEUR, COUNT(DISTINCT ID_INDIVIDU) AS nombre_clients FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc WHERE EXTRACT(YEAR FROM PARSE_DATE('%d/%m/%Y', DATE_TICKET)) = 2023 AND ANNULATION = FALSE AND ANNULATION_IMMEDIATE = FALSE GROUP BY CODE_VENDEUR), VendeurTickets AS (SELECT CODE_VENDEUR, COUNT(DISTINCT NUM_TICKET) AS nombre_tickets FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc WHERE EXTRACT(YEAR FROM PARSE_DATE('%d/%m/%Y', DATE_TICKET)) = 2023 AND ANNULATION = FALSE AND ANNULATION_IMMEDIATE = FALSE GROUP BY CODE_VENDEUR) SELECT vc.CODE_VENDEUR, vt.nombre_tickets, vc.nombre_clients, COALESCE(CAST(vt.nombre_tickets AS NUMERIC) / NULLIF(CAST(vc.nombre_clients AS NUMERIC), 0), 0) AS taux_conversion FROM VendeurClients AS vc JOIN VendeurTickets AS vt ON vc.CODE_VENDEUR = vt.CODE_VENDEUR;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    , INCOMPLETE_SCHEMA                                                                                        , "WITH VendeurClients AS ( SELECT tc.CODE_VENDEUR, COUNT(DISTINCT tc.ID_INDIVIDU) AS nombre_clients FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc WHERE tc.ANNULATION = False GROUP BY tc.CODE_VENDEUR ), VendeurTickets AS ( SELECT tc.CODE_VENDEUR, COUNT(DISTINCT tc.NUM_TICKET) AS nombre_tickets FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc WHERE tc.ANNULATION = False GROUP BY tc.CODE_VENDEUR ) SELECT vc.CODE_VENDEUR, vt.nombre_tickets, vc.nombre_clients, COALESCE(CAST(vt.nombre_tickets AS NUMERIC) / NULLIF(CAST(vc.nombre_clients AS NUMERIC), 0), 0) AS taux_conversion FROM VendeurClients AS vc JOIN VendeurTickets AS vt ON vc.CODE_VENDEUR = vt.CODE_VENDEUR;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ,           0.0,         0.0, False    , True
Quel est le dernier livre de Marc Levy ?                                                                                                                                                                   , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
"Quel produit est le plus à la mode ? (Tendance, nécessite des sources ex"                                                                                                                                 , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quel type de chiffrement est utilisé pour les données sensibles ?                                                                                                                                          , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
"Y a-t-il des promotions en cours sur le site web ? (La base est transactionnelle, pas un site web)"                                                                                                       , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
uels sont les avis des clients sur le magasin de Lille?                                                                                                                                                    , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Comment fonctionne la photosynthèse ?                                                                                                                                                                      , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quels sont les salaires des employés ? (La base ne contient pas d'informations sur les salaires)                                                                                                           , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Comment fidéliser les clients ?                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quel est le taux de TVA appliqué sur les produits ? (Information fiscale absente)                                                                                                                          , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Le magasin de Lyon est-il bien situé ?                                                                                                                                                                     , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
La marque a-t-elle une bonne image ?                                                                                                                                                                       , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quel est l'impact de la météo sur les ventes ?                                                                                                                                                             , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quelle est l'adresse email du service client ? (Aucune information de contact de ce type)                                                                                                                  , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Est-ce que je peux utiliser mes chèques-cadeaux en ligne?                                                                                                                                                  , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quelle est la capitale de l'Australie ?                                                                                                                                                                    , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quelle est la formule chimique de l'eau ?                                                                                                                                                                  , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quel est le volume total (en Go) de la base de données ?                                                                                                                                                   , SELECT SUM(size_bytes)/1024/1024/1024 FROM `region-us`.INFORMATION_SCHEMA.TABLES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             , INCOMPLETE_SCHEMA                                                                                        , SELECT SUM(size_bytes)/1024/1024/1024 FROM `region-us`.INFORMATION_SCHEMA.TABLES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ,           0.0,         0.0, False    , False
"En moyenne, les magasins ""Centre Commercial"" ont-ils un chiffre d'affaires par ticket plus élevé, plus bas, ou équivalent à celui des magasins ""Centre ville"" ?  Donner la différence en pourcentage.", "WITH CA_Centre_Commercial AS ( SELECT AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_moyen_CC FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE m.CENTRE_VILLE = 'Centre Commercial' ), CA_Centre_Ville AS ( SELECT AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_moyen_CV FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE m.CENTRE_VILLE = 'Centre ville' ) SELECT (CA_moyen_CC - CA_moyen_CV) * 100.0 / CA_moyen_CV AS difference_pourcentage FROM CA_Centre_Commercial, CA_Centre_Ville"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    , INCOMPLETE_SCHEMA                                                                                        , "WITH CA_Centre_Commercial AS ( SELECT AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_moyen_CC FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE m.TYPE_MAGASIN = 'Centre Commercial' ), CA_Centre_Ville AS ( SELECT AVG(tc.PRIX_AP_REMISE * tc.QUANTITE) AS CA_moyen_CV FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE m.TYPE_MAGASIN = 'Centre Ville' ) SELECT (CA_moyen_CC - CA_moyen_CV) * 100.0 / CA_moyen_CV AS difference_pourcentage FROM CA_Centre_Commercial, CA_Centre_Ville"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ,           0.0,         0.0, False    , True
Quel est le pourcentage du chiffre d'affaires brut perdu à cause des annulations (ANNULATION = TRUE) sur l'année 2023 ?  Exclure les annulations immédiates (ANNULATION_IMMEDIATE = TRUE)                  , "WITH ventes_2023 AS (SELECT SUM(CASE WHEN ANNULATION = TRUE AND ANNULATION_IMMEDIATE = FALSE THEN PRIX_AP_REMISE * QUANTITE ELSE 0 END) AS ca_annule, SUM(PRIX_AP_REMISE * QUANTITE) AS ca_total FROM avisia-self-service-analytics.reine_des_maracas.ticket_caisse WHERE DATE_TRUNC(PARSE_DATE('%d/%m/%Y', DATE_TICKET), YEAR) = '2023-01-01') SELECT COALESCE(ROUND((ca_annule / NULLIF(ca_total, 0)) * 100, 2), 0) AS pourcentage_ca_perdu FROM ventes_2023;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            , INCOMPLETE_SCHEMA                                                                                        , "WITH CA_2023 AS ( SELECT SUM(CASE WHEN ANNULATION = TRUE AND ANNULATION_IMMEDIATE = FALSE AND SUBSTR(DATE_TICKET, 7, 4) = '2023' THEN PRIX_AP_REMISE * QUANTITE ELSE 0 END) AS ca_annule, SUM(CASE WHEN SUBSTR(DATE_TICKET, 7, 4) = '2023' THEN PRIX_AP_REMISE * QUANTITE ELSE 0 END) AS ca_total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` ) SELECT COALESCE(ROUND((ca_annule / NULLIF(ca_total, 0)) * 100, 2), 0) AS pourcentage_ca_perdu FROM CA_2023;"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ,           0.0,         0.0, False    , True
" Quel est le pourcentage d'évolution du chiffre d'affaires entre le premier trimestre 2021 et le premier trimestre 2023, globalement et par région ?"                                                     , "WITH CA_2021 AS ( SELECT m.REGIONS, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_t1_2021 FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE CAST(SUBSTR(tc.DATE_TICKET, 4, 2) AS INT64) BETWEEN 1 AND 3 AND CAST(SUBSTR(tc.DATE_TICKET, 7, 4) AS INT64) = 2021 AND tc.ANNULATION = False GROUP BY m.REGIONS ), CA_2023 AS ( SELECT m.REGIONS, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_t1_2023 FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE CAST(SUBSTR(tc.DATE_TICKET, 4, 2) AS INT64) BETWEEN 1 AND 3 AND CAST(SUBSTR(tc.DATE_TICKET, 7, 4) AS INT64) = 2023 AND tc.ANNULATION = False GROUP BY m.REGIONS ) SELECT COALESCE(CA_2023.REGIONS, CA_2021.REGIONS) AS region, ca_t1_2021, ca_t1_2023, ROUND(((ca_t1_2023 - ca_t1_2021) / ca_t1_2021) * 100, 2) AS evolution_pourcentage FROM CA_2021 FULL OUTER JOIN CA_2023 ON CA_2021.REGIONS = CA_2023.REGIONS UNION ALL SELECT 'Global', SUM(ca_t1_2021), SUM(ca_t1_2023), ROUND(((SUM(ca_t1_2023) - SUM(ca_t1_2021)) / SUM(ca_t1_2021)) * 100, 2) AS evolution_pourcentage FROM CA_2021 FULL OUTER JOIN CA_2023 ON CA_2021.REGIONS = CA_2023.REGIONS;"                                                                                                                                                                                                                                                          , INCOMPLETE_SCHEMA                                                                                        , "WITH CA_2021 AS ( SELECT m.REGIONS, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_t1_2021 FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE CAST(SUBSTR(tc.DATE_TICKET, 4, 2) AS INT64) IN (1, 2, 3) AND CAST(SUBSTR(tc.DATE_TICKET, 7, 4) AS INT64) = 2021 AND tc.ANNULATION = False GROUP BY m.REGIONS ), CA_2023 AS ( SELECT m.REGIONS, SUM(tc.PRIX_AP_REMISE * tc.QUANTITE) AS ca_t1_2023 FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.magasin` AS m ON tc.CODE_BOUTIQUE = m.CODE_BOUTIQUE WHERE CAST(SUBSTR(tc.DATE_TICKET, 4, 2) AS INT64) IN (1, 2, 3) AND CAST(SUBSTR(tc.DATE_TICKET, 7, 4) AS INT64) = 2023 AND tc.ANNULATION = False GROUP BY m.REGIONS ) SELECT COALESCE(ca23.REGIONS, ca21.REGIONS) AS region, ca_t1_2021, ca_t1_2023, ROUND(((ca_t1_2023 - ca_t1_2021) / ca_t1_2021) * 100, 2) AS evolution_pourcentage FROM CA_2021 AS ca21 FULL OUTER JOIN CA_2023 AS ca23 ON ca21.REGIONS = ca23.REGIONS UNION ALL SELECT 'Global', SUM(ca_t1_2021), SUM(ca_t1_2023), ROUND(((SUM(ca_t1_2023) - SUM(ca_t1_2021)) / SUM(ca_t1_2021)) * 100, 2) AS evolution_pourcentage FROM CA_2021 FULL OUTER JOIN CA_2023 ON CA_2021.REGIONS = CA_2023.REGIONS;",           0.0,         0.0, False    , True
Qui a peint la Joconde ?                                                                                                                                                                                   , SELECT COUNT(DISTINCT FAMILLE) AS total FROM avisia-self-service-analytics.reine_des_maracas.typo_produit                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    , INCOMPLETE_SCHEMA                                                                                        , INCOMPLETE_SCHEMA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ,           0.0,         0.0, False    , False
Quel est le nombre de clients avec un 'SOUSSEG' égal à 'VS' ?                                                                                                                                              , SELECT COUNT(DISTINCT ID_INDIVIDU) AS total FROM `avisia-self-service-analytics.reine_des_maracas.complement_individu` WHERE SOUSSEG = 'VS '                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 , INCOMPLETE_SCHEMA                                                                                        , SELECT COUNT(DISTINCT tc.ID_INDIVIDU) AS total FROM `avisia-self-service-analytics.reine_des_maracas.ticket_caisse` AS tc JOIN `avisia-self-service-analytics.reine_des_maracas.complement_individu` AS ci ON tc.ID_INDIVIDU = ci.ID_INDIVIDU WHERE ci.SOUSSEG = 'VS'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ,           0.0,         0.0, False    , True
Combien de produits différents (ID_ARTICLE) sont référencés ?                                                                                                                                              , SELECT COUNT(DISTINCT ID_ARTICLE) AS total FROM avisia-self-service-analytics.reine_des_maracas.referentiel                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  , INCOMPLETE_SCHEMA                                                                                        , SELECT COUNT(DISTINCT ID_ARTICLE) AS total FROM avisia-self-service-analytics.reine_des_maracas.referentiel                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ,           0.0,         0.0, False    , True
Quel est le nombre de magasins situés en 'PROVINCE' ?                                                                                                                                                      , SELECT COUNT(DISTINCT CODE_BOUTIQUE) AS total FROM `avisia-self-service-analytics.reine_des_maracas.magasin` WHERE REGIONS = 'Province'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      , INCOMPLETE_SCHEMA                                                                                        , SELECT COUNT(DISTINCT CODE_BOUTIQUE) AS total FROM `avisia-self-service-analytics.reine_des_maracas.magasin` WHERE REGIONS = 'PROVINCE'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ,           0.0,         0.0, False    , True
Combien de magasins sont considérés comme 'Centre ville' ?                                                                                                                                                 , SELECT COUNT(DISTINCT CODE_BOUTIQUE) AS total FROM `avisia-self-service-analytics.reine_des_maracas.magasin` WHERE CENTRE_VILLE = 'Centre ville'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             , INCOMPLETE_SCHEMA                                                                                        , SELECT COUNT(DISTINCT CODE_BOUTIQUE) AS total FROM `avisia-self-service-analytics.reine_des_maracas.magasin` WHERE CENTRE_VILLE = 'Oui'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ,           0.0,         0.0, False    , True
